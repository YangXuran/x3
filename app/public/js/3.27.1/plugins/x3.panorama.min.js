/* www.photo.gallery X3.27.1 2019-02-04 */

!function(){function e(e,t,n){k("panorama / "+e,t,n)}var t=!1,n=0;if(window.WebGLRenderingContext)try{var i=document.createElement("canvas");if(i.getContext){var a=i.getContext("webgl")||i.getContext("experimental-webgl");(t=!!(a&&a instanceof WebGLRenderingContext))&&(n=a.getParameter(a.MAX_TEXTURE_SIZE)),e("webgl_support: "+t,null,t?"log":"warn"),e("max_texture_size: "+n)}}catch(t){e("error while trying to detect WebGL",null,"error")}var r,s,l,p,c,u,d,f,h,v,m,g,_,x,w,y,b,z,O,M,C,P,E=x3_settings.plugins.panorama,L="hide"!==E.zoom,R=!1,j=!1,A=E.autorotate_start,I=A&&E.autorotate_restart,T=!1,q=!1,F=0,V=!1,W=!1,N=x3_tests.is_pointer,D=!1,U=[],H={yaw:0,pitch:0,fov:.79},G=window.devicePixelRatio||1,X=window.screen.availWidth*G>=640?640:320;function B(t,i,a){var o=-1,r=0,s={items:[],open:-1};return t.each(function(t,l){var p=$(l);"object"!=typeof p.data("panorama")&&function(t,i){var a=i.data("panorama"),o={},r=!1;a&&"string"==typeof a?a.split("&").forEach(function(e,t){var n=e.split("=");if(n.length>1&&n[1].length){var i=n[1];o[n[0]]=isNaN(i)?"true"===i||"false"!==i&&i:Number(i)}else isNaN(e)?["equirect","cube","flat"].indexOf(e)>-1?o.type=e:e.indexOf("/")>-1||e.match(/\.(jpeg|jpg)$/i)?r=e:o[n[0]]=null:(o.hasOwnProperty("width")?o.hasOwnProperty("height")||(o.height=Number(e)):o.width=Number(e),o.type="equirect")}):a&&"number"==typeof a&&(o.type="equirect",o.width=a),o.hasOwnProperty("type")||(o.hasOwnProperty("width")?o.type=isNaN(o.width)?"flat":"equirect":o.hasOwnProperty("levels")||o.hasOwnProperty("path")?o.type="cube":o.type="equirect");var s="equirect"===o.type?"source":"path",l=o[s]||r||t.getAttribute("data-href")||t.getAttribute("href")||!1;if(l&&(l=l.trim()),l&&(0!==l.toLowerCase().indexOf("http")&&(l.indexOf("content/")>-1?l=x3_settings.path+"/content/"+l.split("content/")[1]:0!==l.indexOf("/")&&(l=x3_settings.path+x3_settings.file_path+"/"+l)),"path"!==s||o.path||r||(l=l.replace(/\.(jpeg|jpg)$/i,"").replace(/\/(?=[^\/]*$)/,"/_"))),o[s]=l?S(l).chompRight("/").s:"none","equirect"===o.type){var p=o.width||i.data("width")||!1,c=o.height||i.data("height")||!1;p&&c||(p?c=Math.floor(p/2):c?p=Math.floor(2*c):(p=4096,c=2048)),o.width=p,o.height=c,p>n&&o.hasOwnProperty("source_4096")&&(null===o.source_4096||!0===o.source_4096)&&(o.source_4096=o.source.replace(/\.(jpeg|jpg)$/i,"_4096.$1"))}else if("flat"===o.type){if(o.hasOwnProperty("url_format")){var u=o.url_format.trim(),d=u.replace(/%0*?[v|y]/g,"{y}").replace(/%0*?[h|x]/g,"{x}").replace(/%0*?l/g,"{z}").replace(/(^|\/)l[0-9](_|\/)/g,"$1l{z}$2").replace(/%0*?c/g,"0");if(d!==o.url_format&&(o.url_format_original=o.url_format,o.url_format=d),!o.hasOwnProperty("index_start")){var f=u.match(/(^|\/)l([0-9])[_|\/]/);o.index_start=f?Math.min(1,f[2]):0}if(!o.hasOwnProperty("zero_padding")){var h=u.match(/%0+?[h|y]/);o.zero_padding=h?h[0].length-1:0}}if(o.hasOwnProperty("width")&&o.hasOwnProperty("height")){var v=o.width.split(","),m=o.height.split(",");o.levels=[],v.forEach(function(e,t){o.levels.push({width:parseInt(e),height:parseInt(m[t])})}),delete o.width,delete o.height}}e("params_to_object: "+a,o),i.data("panorama",o)}(l,p);var c=p.data("panorama");if(["equirect","cube"].indexOf(c.type)>-1){var u={};Object.keys(H).forEach(function(e){var t=c.hasOwnProperty(e)?c[e]:E[e];t!==H[e]&&(3.14===Math.abs(t)&&(t=Math.PI*(t>0?1:-1)),u[e]=t)});var d=c.hasOwnProperty("maxVFov")?c.maxVFov:E.max_vfov,f=c.hasOwnProperty("maxHFov")?c.maxHFov:E.max_hfov;0===f&&(f=null);var h=c.hasOwnProperty("pitch_min")?c.pitch_min:E.pitch_min,v=c.hasOwnProperty("pitch_max")?c.pitch_max:E.pitch_max,m=(-90!==h||90!==v)&&Marzipano.RectilinearView.limit.pitch(h/180*Math.PI,v/180*Math.PI)}if("equirect"===c.type){var g=c.source.indexOf("/content/")>-1&&0!==c.source.toLowerCase().indexOf("http"),_=c.source,x=c.width;if(x>n)if(n>=4096&&c.hasOwnProperty("source_4096"))_=c.source_4096,x=4096;else{if(!g||!E.equirect_resize)return e("Error: Source ["+_+"] width ["+x+"] is > device max_texture_size ["+n+"] and equirect_resize option is disabled, or source is not in content path.",null,"warn"),a?fe(p):p.removeClass("x3-panorama"),!0;_=Mi(_,n),x=n}var w=[{width:x}],y=[_];if(g)if(c.hasOwnProperty("preview")?c.preview:E.equirect_preview){w.unshift({width:X});var b=c.hasOwnProperty("source_4096")?c.source_4096:c.source;y.unshift(Mi(b,X))}var z=c.maxResolution||E.maxres_multiplier*x/4;c.hasOwnProperty("maxResolution")||(c.maxResolution=z);var O=Marzipano.RectilinearView.limit.traditional(z,d,f),M=m?Marzipano.util.compose(O,m):O,C=new Marzipano.ImageUrlSource(function(e){return{url:y[e.z]}}),P=new Marzipano.EquirectGeometry(w),k=new Marzipano.RectilinearView(u,M)}else if("cube"===c.type){C=Marzipano.ImageUrlSource.fromString(c.path+"/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:c.path+"/preview.jpg"});var L=function(e){if("object"==typeof e)return e;for(var t=256,n=[{tileSize:256,size:256,fallbackOnly:!0}],i=0;i<e;i++)n.push({tileSize:512,size:t*=2});return n}(c.levels||3);P=new Marzipano.CubeGeometry(L),z=c.maxResolution||E.maxres_multiplier*(c.face_size||L[L.length-1].size);c.hasOwnProperty("maxResolution")||(c.maxResolution=z);O=Marzipano.RectilinearView.limit.traditional(z,d,f),M=m?Marzipano.util.compose(O,m):O,k=new Marzipano.RectilinearView(u,M)}else{if("flat"!==c.type)return!0;var R=c.tilesize||E.flat_tile_size,j=c.levels;j[1].width<j[0].width&&j.reverse();var A=j[j.length-1];C=function(e){var t=e.url_format||E.flat_url_format,n=e.hasOwnProperty("zero_padding")?e.zero_padding:E.flat_zero_padding,i=e.hasOwnProperty("index_start")?e.index_start:E.flat_index_start;return new Marzipano.ImageUrlSource(function(a){return{url:e.path+"/"+t.replace(/{z}|{y}|{x}/gi,function(e){return"{z}"===e?a.z+i:"{y}"===e?S(a.y+i).padLeft(n,"0").s:"{x}"===e?S(a.x+i).padLeft(n,"0").s:void 0})}})}(c);j.forEach(function(e){e.tileWidth=R,e.tileHeight=R});P=new Marzipano.FlatGeometry(j);var I=A.width/A.height,T=window.innerWidth/window.innerHeight,q=I>T?T/I:1;k=new Marzipano.FlatView({mediaAspectRatio:I,zoom:q},Marzipano.util.compose(Marzipano.FlatView.limit.resolution(A.width),Marzipano.FlatView.limit.letterbox()))}if(a&&p.addClass("x3-panorama"),c.index=r,c.hasOwnProperty("id")||(c.id=l.getAttribute("id")||(c.source||c.path).split("/").filter(Boolean).pop().replace(/\.(jpeg|jpg)$/i,"")),c.hasOwnProperty("title")||(c.title=l.getAttribute("data-title")||l.getAttribute("title")||c.id),c.title&&(c.title=c.title.charAt(0).toUpperCase()+c.title.slice(1)),c.exif=!!l.hasAttribute("data-exif")&&JSON.parse(l.getAttribute("data-exif")),c.description||(c.description=l.getAttribute("data-description")),c.date||(c.date=l.getAttribute("data-date")),c.geo){var F=c.geo.split(",");F.length>2&&(c.geo=F[0]+","+F[1],c.geo_zoom||(c.geo_zoom=parseInt(F[2])))}else c.geo=l.getAttribute("data-geo");-1===s.open&&(i===c.id?s.open=r:-1===o&&c.hasOwnProperty("open")&&(i?o=r:s.open=r)),c.scene_ob={source:C,geometry:P,view:k,pinFirstLevel:!!c.pinFirstLevel},c.original_view=k.parameters(),s.items.push(c),r++}),-1===s.open&&(s.open=o),e("pano_data ["+(a?"content":"gallery")+"]:",s),s}function K(e,t,n){if(R)return!1;R=!0,r=e,F=t,xe(!0);var i=r.items[t],a=E.scene_nav?r.items.length:1;a>1?r.items.forEach(function(e,t){e.scene=s.createScene(e.scene_ob)}):i.scene=s.createScene(i.scene_ob),E.reset_view&&i.scene_ob.view.setParameters(i.original_view),E.scene_nav&&w.toggleClass("hide",a<=1),E.index&&m.toggleClass("hide",a<=1),te(i,a),c.velocity("fadeIn",{duration:200,complete:function(){s.updateSize(),function(){if(!x3_tests.ios)return;Sc.on("orientationchange.pano",function(e){var t=u[0].clientWidth,n=u[0].clientHeight;setTimeout(function(){u[0].clientWidth===t&&u[0].clientHeight===n||s.updateSize()},500)})}(),function(){if(!x3_tests.dual_input)return;var e;Lc.on("touchend.pano",function(t){D=!0,clearTimeout(e),e=setTimeout(function(){D=!1},300)})}(),i.scene.switchTo({transitionDuration:Me,transitionUpdate:ze()},function(){!function(){x3_tests.mobile?f.add(h).addClass("pano-touch"):f.add(h).on("mouseenter.pano mouseleave.pano",function(e){$(this).toggleClass("pano-hover","mouseenter"===e.type)});if(!E.hide_interface)return void ce(!1);de(),u.on("mousemove.pano",$.throttle(Math.floor(E.hide_interface_timeout/10),!1,de)),x3_tests.touch&&(ue(f),ue(h))}(),(A||I)&&ae(!0),s.stage().addEventListener("renderComplete",_e),function(){if("auto"!==E.zoom||!N)return;Sc.on("resize.pano",$.debounce(500,function(e){ee(r.items[F])}))}(),ve(i,a),Q(i,!0)}),V=n||bi("pano")!=i.id&&!navigator.userAgent.match("CriOS"),history.pushState(null,i.id,"#pano="+i.id),Sc.one("popstate.pano",function(e){Z(!1)}),function(e){Lc.on("keydown.pano",function(e){[32,38,40].indexOf(e.which)>-1&&e.preventDefault()}),E.keyboard&&Re.length&&(Le=!1,_.find(".active").removeClass("active"),Lc.on("keydown.pano",function(t){var n=t.which;if(Le!==n){if(t.shiftKey&&e>1&&E.nav&&[37,39].indexOf(n)>-1)return!1;Le=n,je(n,!0)}}));E.keyboard&&Lc.on("keyup.pano",function(t){var n=t.which;if(t.shiftKey&&e>1&&[37,39].indexOf(n)>-1)J(37===n?-1:1);else{if(27===n)return void Z(!0);if(32===n)return ce(!le),void(le&&f.add(h).removeClass("pano-hover"))}Re.length&&je(n,!1)})}(a)}})}function Z(e){if(!R)return!1;R=!1,E.autorotate_start?re():ae(!1),[Sc,Lc,u,d,f,h].forEach(function(e){e.length&&e.off(".pano")}),V?e&&history.back():history.replaceState(null,document.title,location.pathname+location.search),j&&screenfull.exit(),c.velocity("fadeOut",{duration:200,complete:function(){xe(!1),s.destroyAllScenes(),s.stage().removeEventListener("renderComplete",_e),_e(!0),ce(!0),f.add(h).removeClass("pano-hover")}})}function J(e){Q(r.items[F]);var t=F+e,n=r.items.length;if(t<0||t>=n){if(!E.scene_loop)return;t=t<0?n-1:0}F=t;var i=r.items[F];E.reset_view&&i.scene_ob.view.setParameters(i.original_view),E.title&&"0"!=f.css("opacity")&&v.css("display","none"),n>1&&N&&z.add(O).css("display","none"),te(i,n),pe&&E.show_interface_after_nav&&de(),re(),"opacity"!==ye&&i.scene.layer().setEffects({opacity:0}),i.scene.switchTo({transitionDuration:Oe,transitionUpdate:be()},function(){A?oe():I&&ae(!0),E.title&&!v.is(":visible")&&Y(v,!0,3*e,300),n>1&&N&&!D&&(y.is(":hover")&&Y(z,!0,3*e,200),b.is(":hover")&&Y(O,!0,3*e,200)),E.show_interface_after_nav&&(!E.hide_interface&&E.keyboard?ce(!1):le&&de()),ve(i,n),Q(i,!0)}),history.replaceState(null,i.id,"#pano="+i.id)}function Q(t,n){if("flat"===t.type){var i=Math.min(t.levels.length,t.pin_levels||E.flat_pin_levels);if(!(i<2))for(var a=t.scene.layer(),o=1;o<i;o++)e((n?"pinLevel":"unpinLevel")+"("+o+")"),a[n?"pinLevel":"unpinLevel"](o)}}function Y(e,t,n,i,a){e.velocity("stop").velocity({opacity:t?[1,0]:[0,1],translateX:t?[0,n]:[n,0]},{duration:i||300,easing:"easeOutQuint",display:t?a||"auto":"none"})}function ee(e){if("auto"===E.zoom&&N){var t=e.hasOwnProperty("zoom")?e.zoom:"flat"===e.type||e.maxResolution>window.innerWidth*G;x.toggleClass("pano-zoom-hidden",!t)}}function te(e,t){var n=!!(e.exif||e.description||e.geo);if(P.length&&P.toggleClass("hide",!n),E.title&&g.toggleClass("pano-title-info",n),C.length&&C.toggleClass("hide","flat"===e.type),M.data("visible")&&M.toggleClass("hide","flat"===e.type),ee(e),E.scene_nav&&t>1){var i=F<=0?t-1:F-1,a=F>=t-1?0:F+1,o=!1,s=!1;E.scene_loop||(o=i>=F,y.toggleClass("hide",o),s=a<=F,b.toggleClass("hide",s),N&&(z.toggleClass("hide",o),O.toggleClass("hide",s))),N&&(o||z.html(r.items[i].title),s||O.html(r.items[a].title))}E.index&&t>1&&m.text(F+1+" / "+t),E.title&&g.html(e.title)}e("Settings:",E),wi.panorama.init_page=function(e,n){var i=e.is(".context");if(t){var a=B(n,!R&&bi("pano"),i);a.items.length&&(e.on("click",".x3-panorama",function(e){e.target!==this&&$(e.target).is("button, .button, [data-href]")||(e.stopImmediatePropagation(),e.preventDefault(),K(a,$(this).data("panorama").index,!0))}),R||(a.open>-1?K(a,a.open):E.auto_open&&!i&&K(a,0)))}else i?n.each(function(e,t){fe($(t))}):n.removeClass("x3-panorama")},wi.panorama.init_pano=function(){if(t){!function(){var e="",t="";(E.buttons?(E.buttons+",close").replace("close,","").split(","):["close"]).forEach(function(e,n){t+='<button type="button" class="pano-button pano-'+e+(["deviceorientation","fullscreen"].indexOf(e)>-1?" hide":"")+'"></button>'}),e+='<div class="pano-controls">'+t+"</div>";var n="";E.index&&(n+='<span class="pano-index"></span>'),E.title&&(n+='<span class="pano-title"></span>'),(n+='<span class="pano-spinner"></span>')&&(e+='<div class="pano-text">'+n+"</div>"),e&&(e='<div class="pano-topbar">'+e+"</div>");var i="";E.scene_nav&&(i+='<div class="pano-scene-nav"><button type="button" class="pano-button pano-previous"></button><div class="pano-text pano-title-previous"></div><button type="button" class="pano-button pano-next"></button><div class="pano-text pano-title-next"></div></div>');var a="";L&&(a+='<div class="pano-zoom"'+(E.nav?' style="margin-right: 1em;"':"")+'><button type="button" class="pano-button pano-zoom-out"></button><button type="button" class="pano-button pano-zoom-in"></button></div>'),E.nav&&(a+='<button type="button" class="pano-button pano-left"></button><div class="pano-up-down"><button type="button" class="pano-button pano-up"></button><button type="button" class="pano-button pano-down"></button></div><button type="button" class="pano-button pano-right"></button>'),a&&(i+='<div class="pano-nav">'+a+"</div>"),i&&(e+='<div class="pano-bottombar">'+i+"</div>"),e&&(e='<div id="pano-interface" class="pano-interface-hide'+(N?" pano-pointer":"")+'">'+e+"</div>"),Lc.append('<div id="pano-container">'+e+'<div id="pano"></div></div>')}(),c=Lc.find("#pano-container"),u=c.find("#pano"),d=c.find("#pano-interface");var e=(f=d.find(".pano-topbar")).find(".pano-controls");M=e.find(".pano-deviceorientation"),v=f.find(".pano-text"),m=v.find(".pano-index"),g=v.find(".pano-title"),me=v.find(".pano-spinner"),h=d.find(".pano-bottombar"),_=h.find(".pano-nav"),x=_.find(".pano-zoom"),w=h.find(".pano-scene-nav"),y=w.find(".pano-previous"),z=w.find(".pano-title-previous"),b=w.find(".pano-next"),O=w.find(".pano-title-next");var n=(L?89:0)+(E.nav?134:0);if(n){L&&E.nav&&(n+=16);var i=Math.round(n/2+60);E.scene_nav&&o("@media (min-width: 641px) { .pano-title-previous, .pano-title-next { max-width: calc(50% - "+i+"px); } }"),L&&E.nav&&(o("@media (min-width: 1025px) { .pano-nav { margin-left: -106px; } }"),E.scene_nav&&(o("@media (min-width: 1025px) { .pano-title-previous { max-width: calc(50% - "+(i+53)+"px); } }"),o("@media (min-width: 1025px) { .pano-title-next { max-width: calc(50% - "+(i-53)+"px); }")))}if(s=new Marzipano.Viewer(u[0]),E.nav&&U.push([_.find(".pano-up"),"y",-.5,.75],[_.find(".pano-down"),"y",.5,.75],[_.find(".pano-left"),"x",-1],[_.find(".pano-right"),"x",1]),L&&U.push([_.find(".pano-zoom-in"),"zoom",-1],[_.find(".pano-zoom-out"),"zoom",1]),E.keyboard&&U.push([38,"y",-.5,.75],[40,"y",.5,.75],[37,"x",-1],[39,"x",1],[187,"zoom",-1],[189,"zoom",1],[107,"zoom",-1],[109,"zoom",1],[87,"y",-.5,.75],[65,"x",-1],[83,"y",.5,.75],[68,"x",1],[81,"roll",-4,6],[69,"roll",4,6]),U.length){l=s.controls(),U.forEach(function(e,t){var n=.4*e[2],i=1.2*(e[3]||1),a="number"==typeof e[0]?new Marzipano.KeyControlMethod(e[0],e[1],n,i):new Marzipano.ElementPressControlMethod(e[0][0],e[1],n,i);l.registerMethod("c"+t,a,!0)})}var a=e.find(".pano-close");a.length&&a.on("click",function(e){Z(!0)}),(P=e.find(".pano-info")).length&&P.on("click",H),E.title&&g.on("click",function(e){$(this).hasClass("pano-title-info")&&H()});var k=e.find(".pano-reset-view");k.length&&k.on("click",function(e){k.data("translating")||(k.data("translating",!0),s.lookTo(r.items[F].original_view,{transitionDuration:500},function(){k.data("translating",!1)}))});var S=Marzipano.dependencies.hammerjs,R=e.find(".pano-fullscreen");(E.fullscreen_taps||R.length)&&vi("screenfull",function(e){if(!e)return R.remove(),!1;(R.removeClass("hide").on("click",function(){screenfull.toggle()}),E.fullscreen_taps)&&new S(u[0]).on(1===E.fullscreen_taps?"tap":"doubletap",function(e){j||screenfull.request()});function t(){j=screenfull.isFullscreen,R.toggleClass("pano-is-fullscreen",j)}screenfull.on("change",t),t()}),(C=e.find(".pano-rotate")).length&&C.on("click",function(){ae(!A)});var I=E.autorotate_speed;if(p=Marzipano.autorotate({yawSpeed:I,yawAccel:I/2,pitchSpeed:Math.max(I,.1),pitchAccel:Math.max(I/2,.05)}),E.lookto_taps){function T(e,t,n){var i=s["_hammerManager"+e];i.manager().add(new S.Tap({taps:t,posThreshold:n})),i.on("tap",function(e){var t=s.view().screenToCoordinates(e.center);s.lookTo(t,{transitionDuration:500})})}N&&T("Mouse",E.lookto_taps,20),x3_tests.touch&&T("Touch",E.lookto_taps,50)}if(M.length)if(x3_tests.device_orientation){function V(){vi("DeviceOrientationControlMethod",function(e){if(!e)return M.remove(),!1;l.registerMethod("deviceOrientation",new DeviceOrientationControlMethod),M.removeClass("hide").data("visible",!0).on("click",function(e){ie(!q)})})}x3_tests.device_oriented?V():Sc.one("deviceorientation.panotest",function(e){var t=e.originalEvent.alpha;null===t||isNaN(t)||V()})}else M.remove();if(E.scene_nav){function W(e,t,n){e.on("click",$.throttle(500,!0,function(){J(n)})),N&&e.on("mouseenter mouseleave",function(e){D||Y(t,"mouseenter"===e.type,3*n)})}W(y,z,-1),W(b,O,1)}}function H(){var e=r.items[F],t=!1,n='<h2 class="pano-info-title">'+e.title+"</h3>";if(e.date&&(n+='<time class="pano-info-date">'+e.date+"</time>"),e.exif&&(n+='<div class="pano-info-exif">'+oo(e.exif)+"</div>"),e.description&&(n+='<p class="pano-info-description">'+e.description+"</p>"),e.geo){var i=document.documentElement.clientWidth;if(i<=640)t=Math.min(100*Math.ceil(i/100),640);else{var a=document.documentElement.clientHeight;t=a<800?400:a<950?500:640}n+='<a href="https://www.google.com/maps/search/?api=1&amp;query='+e.geo+'" class="pano-info-map" target="_blank"><div class="pano-info-map-container"><img src="https://maps.googleapis.com/maps/api/staticmap?'+(x3_tests.pixel_ratio>1?"scale=2&amp;":"")+"zoom="+(e.geo_zoom||12)+"&amp;size="+t+"x"+t+"&amp;markers="+e.geo+'&amp;key=AIzaSyDRp6xla9SxUmTBu6l_kprhjjI9e5-EVZk" class="pano-info-map-image"></div></a>'}var o=gc(n,t,"pano-info-modal");if(e.geo){var s=o.find(".pano-info-map-image");s.on("load",function(e){s.css({opacity:1,transform:"scale(1)"})}),o.find(".pano-info-map").on("click",function(t){gi("https://www.google.com/maps/embed/v1/place?q="+e.geo+"&amp;key=AIzaSyDRp6xla9SxUmTBu6l_kprhjjI9e5-EVZk",t).css("z-index",1542)})}}};var ne=!1;function ie(e){q!==e&&(q=e,M.toggleClass("pano-is-deviceorientation",e),e?(ne=A,ae(!1),l.enableMethod("deviceOrientation")):(l.disableMethod("deviceOrientation"),ne&&ae(!0)))}function ae(e){T!==e&&(A=e,C.toggleClass("pano-rotating",e),e?oe():re())}function oe(){T||(ie(!1),s.startMovement(p),s.setIdleMovement(E.autorotate_idlemovement_timeout,p),T=!0)}function re(){T&&(s.stopMovement(),s.setIdleMovement(1/0),T=!1)}var se,le=!0,pe=!1;function ce(e){pe&&(pe=!1,clearTimeout(se)),le!==e&&(le=e,d.toggleClass("pano-interface-hide",e))}function ue(e){e.length&&e.on("touchstart.pano",".pano-button",function(t){if("1"!=e.css("opacity"))return!1})}function de(){ce(!1),pe=!0,se=setTimeout(function(){ce(!0)},E.hide_interface_timeout)}function fe(e){var t=e.attr("data-href")||e.attr("href");t&&t.indexOf(".")>-1&&e.attr({"data-popup":"",rel:"pano-replacement-popup",href:(-1===t.indexOf("/")?x3_page.file_path+"/":"")+t.trim()})}function he(t){var n=r.items[t];n.scene_ob.pinFirstLevel||n.scene_ob.geometry.levelList.length<2||!s.hasScene(n.scene)||(e("pinFirstLevel: "+n.id),n.scene.layer().pinFirstLevel(),n.scene_ob.pinFirstLevel=!0)}function ve(e,t){t<2||setTimeout(function(){s.hasScene(e.scene)&&e.scene.visible()&&(he(F>=t-1?0:F+1),he(F<=0?t-1:F-1))},2e3)}var me,ge=!1;function _e(e){ge===e&&(ge=!ge,me.toggleClass("pano-spinning",ge))}function xe(e){e!==W&&(e?(W=window.innerWidth-document.documentElement.clientWidth)&&(Pc[0].style["padding-right"]=W+"px",Rc[0].style.overflow="hidden"):(Pc[0].style.removeProperty("padding-right"),Rc[0].style.removeProperty("overflow"),W=!1))}var we={opacity:function(){return function(e,t){var n=Ee(e),i={opacity:n};Pe&&(i.rect=Pe(n)),t.layer().setEffects(i)}},black:function(){return function(e,t,n){var i=Ee(e),a=i<.5,o=a?2*i:1-2*(i-.5),r=a?n.layer():t.layer(),s={colorOffset:[-o,-o,-o,0]};!a&&Pe&&(s.rect=Pe(i)),r.setEffects(s)}},black_first:function(){return function(e,t){var n=Ee(e),i=1-n,a={colorOffset:[-i,-i,-i,0]};Pe&&(a.rect=Pe(n)),t.layer().setEffects(a)}}},ye=E.transition,be=we[ye],ze="black"===ye?we.black_first:be,Oe=E.transition_duration,Me="black"===ye?Oe/2:Oe,Ce=E.transition_scale;if(Ce&&Oe)var Pe=function(e){return{relativeWidth:ke-e*Ce,relativeHeight:ke-e*Ce,relativeX:e*Se-Se,relativeY:e*Se-Se}},ke=1+Ce,Se=Ce/2;else Pe=!1;function Ee(e){return-(Math.pow(e-1,4)-1)}var Le=!1,Re=(E.nav?[38,40,37,39]:[]).concat(L?[187,189]:[]);function je(e,t){var n=Re.indexOf(e);if(n>-1){if(t&&"1"!=h.css("opacity"))return;Le=!1,U[n][0].toggleClass("active",t)}}}();